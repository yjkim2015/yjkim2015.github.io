---
title: JPA 엔티티 매핑
categories:
- JPA
toc: true
toc_sticky: true
toc_label: 목차
---

## Step 1:  객체와 테이블 매핑

#### @Entity

* **@Entity가 붙은 클래스는 JPA가 관리하는 객체이다.**
* **JPA를 사용해서 테이블과 매핑할 클래스는 <span style="color:red;">@Entity</span> 필수**

* **<span style="color:red;">주의</span>**
  * **기본 생성자 필수 (파라미터가 없는 public 또는 protected 생성자)**
  * **final 클래스, enum, interface, inner 클래스 사용 X**
  * **저장할 필드에 final 사용 X**

* **속성 : name**
  * **JPA에서 사용할 엔티티 이름을 지정한다.**
  * **기본값 : 클래스 이름을 그대로 사용** 
  * **같은 클래스 이름이 없으면 가급적 기본 값을 사용한다.**



## Step 2:  데이터베이스 스키마 자동 생성

* **DDL을** **애플리케이션 실행 시점에 자동 생성**

  * ```
    <property name="hibernate.hbm2ddl.auto" value="create"/>
    
    create 		-> 기존테이블 삭제 후 다시 생성 (DROP + CREATE)
    create-drop -> create와 같으나 종료시점에 테이블 DROP
    update 		-> 변경분만 반영(운영DB에는 사용하면 안됨)
    validate 	-> 엔티티와 테이블이 정상 매핑되었는지만 확인
    none 		-> 사용하지 않음
    ```

  * **JPA에서는 애플리케이션 로딩 시점에 DB TABLE을 생성하는 기능을 지원한다. <span style="color:red;">하지만, 실제 운영에선 사용하면 안되고 개발이나 로컬단계에서 사용하기에 유용하다.</span>**

* 테이블 중심 -> 객체 중심

* <span style="color:red;">데이터베이스 방언</span>을 활용해서 데이터베이스에 맞는 적절한 DDL 생성

* **<span style="color:red;">주의</span>**

  * ***<span style="color:red;"> 운영 서버에는 절대 create 또는 create-drop, update 사용하면 안된다.</span>***
  * **개발 초기 단계는 create 또는 update**
  * **테스트 서버는 update 또는 validate**
  * **스테이징과 운영 서버는 validate 또는 none**

* DDL 생성 기능

  * 제약조건 추가 : ex) 회원 이름은 필수, 10자 초과X
    * @Column(nullable = false, length = 10)
  * 유니크 제약 조건 추가
    * ex) @Column(unique = true)
  * DDL 생성 기능은 DDL을 자동 생성할 때만 사용되고 JPA의 실행 로직에는 영향을 주지 않는다.

```
참조 - 자바 ORM 표준 JPA 프로그래밍 By 김영한
```

